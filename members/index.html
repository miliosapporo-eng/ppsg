<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Members | Ë¶ã„Å§„ÇÅ„ÇãÂÜôÁúü„ÅÆ„ÅØ„Åò„ÇÅÂûã</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;600&display=swap" rel="stylesheet">
    
    <script>
        // Ë™çË®º„ÉÅ„Çß„ÉÉ„ÇØ
        if (localStorage.getItem('pt_auth_token_v1') !== 'xc9-access-granted') {
            window.location.href = '/';
        }
    </script>
    
    <style>
        body { font-family: sans-serif; background-color: #0f172a; color: #e2e8f0; }
        .font-serif { font-family: 'Noto Serif JP', serif; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* OS Badge Style */
        .os-badge {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            color: #fbbf24;
            font-size: 9px;
            padding: 2px 6px;
            letter-spacing: 0.05em;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <header class="p-6 border-b border-gray-800 flex justify-between items-center sticky top-0 bg-gray-900/95 backdrop-blur z-50">
        <div class="flex items-center gap-4">
            <a href="/" class="text-xs text-gray-500 hover:text-white transition-colors tracking-widest flex items-center gap-1">
                <i data-lucide="arrow-left" class="w-3 h-3"></i> HOME
            </a>
            <h1 class="text-xl font-serif font-bold tracking-widest text-white border-l border-gray-700 pl-4 ml-4">
                MEMBERS LIST
            </h1>
        </div>
        <div class="flex items-center gap-6">
            <span class="text-[10px] text-gray-500 uppercase tracking-widest hidden md:inline">Logged in as Member</span>
            <button onclick="logout()" class="text-xs font-bold tracking-widest text-red-400 hover:text-red-300 transition-colors border border-red-900/50 hover:bg-red-900/20 px-4 py-2 rounded">
                LOGOUT
            </button>
        </div>
    </header>

    <div class="p-6 border-b border-gray-800 overflow-x-auto bg-gray-900">
        <div class="flex gap-8 text-xs font-bold tracking-widest whitespace-nowrap min-w-max">
            <button onclick="filterMembers('All')" data-filter="All" class="filter-btn text-white border-b-2 border-white pb-1 transition-colors">ALL MEMBERS</button>
            <button onclick="filterMembers('Photographer')" data-filter="Photographer" class="filter-btn text-gray-500 hover:text-white transition-colors pb-1 border-b-2 border-transparent hover:border-gray-700">PHOTOGRAPHERS</button>
            <button onclick="filterMembers('Model')" data-filter="Model" class="filter-btn text-gray-500 hover:text-white transition-colors pb-1 border-b-2 border-transparent hover:border-gray-700">MODELS</button>
            <button onclick="filterMembers('HairMakeup')" data-filter="HairMakeup" class="filter-btn text-gray-500 hover:text-white transition-colors pb-1 border-b-2 border-transparent hover:border-gray-700">HAIR & MAKE</button>
            <button onclick="filterMembers('Location')" data-filter="Location" class="filter-btn text-gray-500 hover:text-white transition-colors pb-1 border-b-2 border-transparent hover:border-gray-700">LOCATIONS</button>
            <button onclick="filterMembers('Gallery')" data-filter="Gallery" class="filter-btn text-gray-500 hover:text-white transition-colors pb-1 border-b-2 border-transparent hover:border-gray-700">GALLERIES</button>
            <button onclick="filterMembers('Enthusiast')" data-filter="Enthusiast" class="filter-btn text-gray-500 hover:text-white transition-colors pb-1 border-b-2 border-transparent hover:border-gray-700">ENTHUSIASTS</button>
        </div>
    </div>

    <main class="p-6 flex-1">
        <div id="members-grid" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <!-- Loading Spinner -->
            <div class="col-span-full text-center py-20 text-gray-500">
                <i data-lucide="loader-2" class="w-8 h-8 animate-spin mx-auto mb-4"></i>
                <p class="text-xs tracking-widest">LOADING MEMBERS DATA...</p>
            </div>
        </div>
    </main>

    <script>
        lucide.createIcons();
        const API_URL = "https://script.google.com/macros/s/AKfycbxCjTZEEJdglIlZO_ExjqK0_gMtafvZNWKGo3lEXTP9tzT-rO9GNUG2G3WsqF2JumDD/exec";
        let allMembers = [];

        // OS„Çø„Ç§„Éó„Å´Âøú„Åò„ÅüÁµµÊñáÂ≠ó„Å®„É©„Éô„É´„ÇíËøî„Åô„Éò„É´„Éë„Éº
        function getOSInfo(osName) {
            const osMap = {
                'OWL': 'ü¶â OWL', 'WOLF': 'üê∫ WOLF', 'EAGLE': 'ü¶Ö EAGLE',
                'DOLPHIN': 'üê¨ DOLPHIN', 'CROW': 'üê¶‚Äç‚¨õ CROW', 'DOVE': 'üïäÔ∏è DOVE',
                'LIZARD': 'ü¶é LIZARD', 'GIRAFFE': 'ü¶í GIRAFFE', 'DOG': 'üêï DOG',
                'LION': 'ü¶Å LION', 'SWAN': 'ü¶¢ SWAN', 'JELLY': 'ü™º JELLY'
            };
            return osMap[osName] || null;
        }

        function logout() {
            if(confirm('„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åô„ÅãÔºü')) {
                localStorage.removeItem('pt_auth_token_v1');
                window.location.href = '/';
            }
        }

        async function fetchMembers() {
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                
                if (!data || data.length === 0) {
                    document.getElementById('members-grid').innerHTML = `
                        <div class="col-span-full text-center py-20 text-gray-600">
                            <p class="text-xs tracking-widest">NO MEMBERS REGISTERED YET.</p>
                        </div>`;
                    return;
                }
                allMembers = data; 
                filterMembers('All'); 
            } catch (error) {
                console.error("Fetch Error:", error);
                document.getElementById('members-grid').innerHTML = `
                    <div class="col-span-full text-center py-20 text-red-400">
                        <p class="text-xs tracking-widest">FAILED TO LOAD DATA.</p>
                    </div>`;
            }
        }

        function filterMembers(filterType) {
            const container = document.getElementById('members-grid');
            container.innerHTML = '';
            const filtered = filterType === 'All' ? allMembers : allMembers.filter(m => m.type === filterType);

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center py-20 text-gray-600">
                        <p class="text-xs tracking-widest">NO MEMBERS FOUND IN THIS CATEGORY.</p>
                    </div>`;
            } else {
                filtered.forEach(m => {
                    const imgUrl = m.image ? m.image : 'https://via.placeholder.com/400x500/1f2937/4b5563?text=NO+IMAGE';
                    const osInfo = m.os_type ? getOSInfo(m.os_type) : null;
                    
                    const card = `
                        <a href="profile.html?id=${m.id}" class="block bg-gray-800 border border-gray-700 hover:border-gray-500 transition-all duration-300 group relative overflow-hidden">
                            <div class="aspect-[4/5] overflow-hidden bg-black relative">
                                <img src="${imgUrl}" 
                                     class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700 opacity-90 group-hover:opacity-100" 
                                     referrerpolicy="no-referrer"
                                     onerror="this.onerror=null; this.src='https://via.placeholder.com/400x500/1f2937/4b5563?text=NO+IMAGE';">
                                
                                <div class="absolute top-2 right-2">
                                    <span class="text-[9px] font-bold px-2 py-1 uppercase tracking-wider backdrop-blur-sm ${m.status === 'Active' ? 'bg-green-900/60 text-green-300 border border-green-800' : 'bg-red-900/60 text-red-300 border border-red-800'}">
                                        ${m.status || 'Active'}
                                    </span>
                                </div>
                                <div class="absolute bottom-0 left-0 p-4 w-full bg-gradient-to-t from-black/80 to-transparent flex flex-wrap gap-2">
                                    <span class="text-[10px] bg-white/10 backdrop-blur px-2 py-1 text-white border border-white/20 uppercase tracking-wider">
                                        ${m.type}
                                    </span>
                                    ${osInfo ? `<span class="os-badge backdrop-blur uppercase tracking-wider font-bold">${osInfo}</span>` : ''}
                                </div>
                            </div>
                            <div class="p-5">
                                <h3 class="text-lg font-serif text-white mb-2 tracking-wide group-hover:text-amber-400 transition-colors">${m.name}</h3>
                                <p class="text-[10px] text-gray-400 mb-4 flex items-center gap-1 uppercase tracking-widest">
                                    <i data-lucide="map-pin" class="w-3 h-3"></i> ${m.location || 'Unknown'}
                                </p>
                                <div class="border-t border-gray-700 pt-3">
                                    <p class="text-xs text-gray-500 line-clamp-2 italic font-serif leading-relaxed">
                                        "${m.philosophy || '...'}"
                                    </p>
                                </div>
                            </div>
                        </a>
                    `;
                    container.innerHTML += card;
                });
            }

            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.dataset.filter === filterType) {
                    btn.classList.remove('text-gray-500', 'border-transparent');
                    btn.classList.add('text-white', 'border-white');
                } else {
                    btn.classList.add('text-gray-500', 'border-transparent');
                    btn.classList.remove('text-white', 'border-white');
                }
            });
            lucide.createIcons();
        }

        window.onload = fetchMembers;
    </script>
</body>
</html>
